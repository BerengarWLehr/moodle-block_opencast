{"version":3,"sources":["../src/block_settings.js"],"names":["init","rolesinputid","metadatainputid","metadataseriesinputid","ocinstanceid","str","get_strings","key","component","then","jsstrings","rolesinput","parent","hide","next","length","metadatainput","metadataseriesinput","rolestable","Tabulator","data","JSON","parse","val","layout","dataChanged","filter","value","rolename","stringify","columns","title","field","editor","widthGrow","cellEdited","cell","getData","includes","getRow","update","getCell","getElement","getElementsByTagName","disabled","hozAlign","formatter","input","document","createElement","type","checked","getValue","addEventListener","prop","width","headerSort","cellClick","e","ModalFactory","create","types","SAVE_CANCEL","body","modal","setSaveButtonText","getRoot","on","ModalEvents","save","delete","show","click","addRow","metadatatable","movableRows","rowMoved","getRows","map","row","name","html","editorParams","values","metadataseriestable"],"mappings":"ihBAuBA,OACA,OACA,OACA,OACA,O,ylBAEO,GAAMA,CAAAA,CAAI,CAAG,SAACC,CAAD,CAAeC,CAAf,CAAgCC,CAAhC,CAAuDC,CAAvD,CAAwE,CAmBxFC,CAAG,CAACC,WAAJ,CAhBc,CACV,CAACC,GAAG,CAAE,cAAN,CAAsBC,SAAS,CAAE,gBAAjC,CADU,CAEV,CAACD,GAAG,CAAE,iBAAN,CAAyBC,SAAS,CAAE,gBAApC,CAFU,CAGV,CAACD,GAAG,CAAE,mBAAN,CAA2BC,SAAS,CAAE,gBAAtC,CAHU,CAIV,CAACD,GAAG,CAAE,aAAN,CAAqBC,SAAS,CAAE,gBAAhC,CAJU,CAKV,CAACD,GAAG,CAAE,qBAAN,CAA6BC,SAAS,CAAE,gBAAxC,CALU,CAMV,CAACD,GAAG,CAAE,iBAAN,CAAyBC,SAAS,CAAE,gBAApC,CANU,CAOV,CAACD,GAAG,CAAE,yBAAN,CAAiCC,SAAS,CAAE,gBAA5C,CAPU,CAQV,CAACD,GAAG,CAAE,cAAN,CAAsBC,SAAS,CAAE,gBAAjC,CARU,CASV,CAACD,GAAG,CAAE,kBAAN,CAA0BC,SAAS,CAAE,gBAArC,CATU,CAUV,CAACD,GAAG,CAAE,qBAAN,CAA6BC,SAAS,CAAE,gBAAxC,CAVU,CAWV,CAACD,GAAG,CAAE,kBAAN,CAA0BC,SAAS,CAAE,gBAArC,CAXU,CAYV,CAACD,GAAG,CAAE,kBAAN,CAA0BC,SAAS,CAAE,gBAArC,CAZU,CAaV,CAACD,GAAG,CAAE,gBAAN,CAAwBC,SAAS,CAAE,gBAAnC,CAbU,CAcV,CAACD,GAAG,CAAE,QAAN,CAAgBC,SAAS,CAAE,QAA3B,CAdU,CAgBd,EAAyBC,IAAzB,CAA8B,SAAUC,CAAV,CAAqB,CAE/C,GAAIC,CAAAA,CAAU,CAAG,cAAE,IAAMV,CAAR,CAAjB,CACAU,CAAU,CAACC,MAAX,GAAoBC,IAApB,GACAF,CAAU,CAACC,MAAX,GAAoBE,IAApB,GAA2BD,IAA3B,GAGA,GAAG,CAACF,CAAU,CAACI,MAAf,CAAuB,CACnB,MACH,CAED,GAAIC,CAAAA,CAAa,CAAG,cAAE,IAAMd,CAAR,CAApB,CACAc,CAAa,CAACJ,MAAd,GAAuBC,IAAvB,GACAG,CAAa,CAACJ,MAAd,GAAuBE,IAAvB,GAA8BD,IAA9B,GAEA,GAAII,CAAAA,CAAmB,CAAG,cAAE,IAAMd,CAAR,CAA1B,CACAc,CAAmB,CAACL,MAApB,GAA6BC,IAA7B,GACAI,CAAmB,CAACL,MAApB,GAA6BE,IAA7B,GAAoCD,IAApC,GAEA,GAAIK,CAAAA,CAAU,CAAG,GAAIC,UAAJ,CAAc,eAAiBf,CAA/B,CAA6C,CAC1DgB,IAAI,CAAEC,IAAI,CAACC,KAAL,CAAWX,CAAU,CAACY,GAAX,EAAX,CADoD,CAE1DC,MAAM,CAAE,YAFkD,CAG1DC,WAAW,CAAE,qBAAUL,CAAV,CAAgB,CACzBA,CAAI,CAAGA,CAAI,CAACM,MAAL,CAAY,SAAAC,CAAK,QAAIA,CAAAA,CAAK,CAACC,QAAV,CAAjB,CAAP,CACAjB,CAAU,CAACY,GAAX,CAAeF,IAAI,CAACQ,SAAL,CAAeT,CAAf,CAAf,CACH,CANyD,CAO1DU,OAAO,CAAE,CACL,CACIC,KAAK,CAAErB,CAAS,CAAC,CAAD,CADpB,CACyBsB,KAAK,CAAE,UADhC,CAC4CC,MAAM,CAAE,OADpD,CAC6DC,SAAS,CAAE,CADxE,CAC2EC,UAAU,CAAE,oBAAUC,CAAV,CAAgB,CAC/F,GAAIA,CAAI,CAACC,OAAL,GAAeT,QAAf,CAAwBU,QAAxB,CAAiC,YAAjC,GAAkDF,CAAI,CAACC,OAAL,GAAeT,QAAf,CAAwBU,QAAxB,CAAiC,gBAAjC,CAAlD,EACAF,CAAI,CAACC,OAAL,GAAeT,QAAf,CAAwBU,QAAxB,CAAiC,eAAjC,CADJ,CACuD,CAEnDF,CAAI,CAACG,MAAL,GAAcC,MAAd,CAAqB,CAAC,UAAa,CAAd,CAArB,EACAJ,CAAI,CAACG,MAAL,GAAcE,OAAd,CAAsB,WAAtB,EAAmCC,UAAnC,GAAgDC,oBAAhD,CAAqE,OAArE,EAA8E,CAA9E,EAAiFC,QAAjF,GACH,CALD,IAKO,CACHR,CAAI,CAACG,MAAL,GAAcE,OAAd,CAAsB,WAAtB,EAAmCC,UAAnC,GAAgDC,oBAAhD,CAAqE,OAArE,EAA8E,CAA9E,EAAiFC,QAAjF,GACH,CACJ,CAVL,CADK,CAaL,CAACb,KAAK,CAAErB,CAAS,CAAC,CAAD,CAAjB,CAAsBsB,KAAK,CAAE,SAA7B,CAAwCC,MAAM,CAAE,OAAhD,CAAyDC,SAAS,CAAE,CAApE,CAbK,CAcL,CACIH,KAAK,CAAErB,CAAS,CAAC,CAAD,CADpB,CAEIsB,KAAK,CAAE,WAFX,CAGIa,QAAQ,CAAE,QAHd,CAIIX,SAAS,CAAE,CAJf,CAKIY,SAAS,CAAE,mBAAUV,CAAV,CAAgB,CACvB,GAAIW,CAAAA,CAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ,CACAF,CAAK,CAACG,IAAN,CAAa,UAAb,CACAH,CAAK,CAACI,OAAN,CAAgBf,CAAI,CAACgB,QAAL,EAAhB,CACAL,CAAK,CAACM,gBAAN,CAAuB,OAAvB,CAAgC,UAAY,CACxCjB,CAAI,CAACG,MAAL,GAAcC,MAAd,CAAqB,CAAC,UAAa,cAAE,IAAF,EAAQc,IAAR,CAAa,SAAb,EAA0B,CAA1B,CAA8B,CAA5C,CAArB,CACH,CAFD,EAIA,GAAIlB,CAAI,CAACC,OAAL,GAAeT,QAAf,CAAwBU,QAAxB,CAAiC,YAAjC,GAAkDF,CAAI,CAACC,OAAL,GAAeT,QAAf,CAAwBU,QAAxB,CAAiC,gBAAjC,CAAlD,EACAF,CAAI,CAACC,OAAL,GAAeT,QAAf,CAAwBU,QAAxB,CAAiC,eAAjC,CADJ,CACuD,CACnDS,CAAK,CAACH,QAAN,GACH,CAED,MAAOG,CAAAA,CACV,CAnBL,CAdK,CAmCL,CACIhB,KAAK,CAAE,EADX,CAEIwB,KAAK,CAAE,EAFX,CAGIC,UAAU,GAHd,CAIIX,QAAQ,CAAE,QAJd,CAKIC,SAAS,CAAE,oBAAY,CACnB,MAAO,0CACV,CAPL,CAQIW,SAAS,CAAE,mBAAUC,CAAV,CAAatB,CAAb,CAAmB,CAC1BuB,UAAaC,MAAb,CAAoB,CAChBV,IAAI,CAAES,UAAaE,KAAb,CAAmBC,WADT,CAEhB/B,KAAK,CAAErB,CAAS,CAAC,CAAD,CAFA,CAGhBqD,IAAI,CAAErD,CAAS,CAAC,CAAD,CAHC,CAApB,EAKKD,IALL,CAKU,SAAUuD,CAAV,CAAiB,CACnBA,CAAK,CAACC,iBAAN,CAAwBvD,CAAS,CAAC,CAAD,CAAjC,EACAsD,CAAK,CAACE,OAAN,GAAgBC,EAAhB,CAAmBC,UAAYC,IAA/B,CAAqC,UAAY,CAC7CjC,CAAI,CAACG,MAAL,GAAc+B,MAAd,EACH,CAFD,EAGAN,CAAK,CAACO,IAAN,EACH,CAXL,CAYH,CArBL,CAnCK,CAPiD,CAA7C,CAAjB,CAoEA,cAAE,sBAAwBnE,CAA1B,EAAwCoE,KAAxC,CAA8C,UAAY,CACtDtD,CAAU,CAACuD,MAAX,CAAkB,CAAC,SAAY,EAAb,CAAiB,QAAU,EAA3B,CAA+B,UAAa,CAA5C,CAAlB,CACH,CAFD,EAIA,GAAIC,CAAAA,CAAa,CAAG,GAAIvD,UAAJ,CAAc,kBAAoBf,CAAlC,CAAgD,CAChEgB,IAAI,CAAEC,IAAI,CAACC,KAAL,CAAWN,CAAa,CAACO,GAAd,EAAX,CAD0D,CAEhEC,MAAM,CAAE,YAFwD,CAGhEmD,WAAW,GAHqD,CAIhEC,QAAQ,CAAE,mBAAY,CAElB,GAAIxD,CAAAA,CAAI,CAAGsD,CAAa,CAACG,OAAd,GAAwBC,GAAxB,CAA4B,SAAAC,CAAG,QAAIA,CAAAA,CAAG,CAAC1C,OAAJ,EAAJ,CAA/B,CAAX,CACAjB,CAAI,CAAGA,CAAI,CAACM,MAAL,CAAY,SAAAC,CAAK,QAAIA,CAAAA,CAAK,CAACqD,IAAV,CAAjB,CAAP,CACAhE,CAAa,CAACO,GAAd,CAAkBF,IAAI,CAACQ,SAAL,CAAeT,CAAf,CAAlB,CACH,CAT+D,CAUhEK,WAAW,CAAE,sBAAY,CAErB,GAAIL,CAAAA,CAAI,CAAGsD,CAAa,CAACG,OAAd,GAAwBC,GAAxB,CAA4B,SAAAC,CAAG,QAAIA,CAAAA,CAAG,CAAC1C,OAAJ,EAAJ,CAA/B,CAAX,CACAjB,CAAI,CAAGA,CAAI,CAACM,MAAL,CAAY,SAAAC,CAAK,QAAIA,CAAAA,CAAK,CAACqD,IAAV,CAAjB,CAAP,CACA,cAAE,IAAM9E,CAAR,EAAyBqB,GAAzB,CAA6BF,IAAI,CAACQ,SAAL,CAAeT,CAAf,CAA7B,CACH,CAf+D,CAgBhEU,OAAO,CAAE,CACL,CACIC,KAAK,CAAErB,CAAS,CAAC,CAAD,CAAT,CAAe,KAAf,CAAuB,cAAE,gBAAkBN,CAApB,EAAkC6E,IAAlC,EADlC,CAEIjD,KAAK,CAAE,MAFX,CAGIC,MAAM,CAAE,OAHZ,CAIIC,SAAS,CAAE,CAJf,CAKIsB,UAAU,GALd,CADK,CAQL,CACIzB,KAAK,CAAErB,CAAS,CAAC,CAAD,CADpB,CACyBsB,KAAK,CAAE,UADhC,CAC4CE,SAAS,CAAE,CADvD,CAC0DsB,UAAU,GADpE,CAC6EvB,MAAM,CAAE,QADrF,CAC+FiD,YAAY,CACnG,CACIC,MAAM,CAAE,CACJ,KAAQ,eADJ,CAEJ,OAAU,oBAFN,CAGJ,aAAgB,uBAHZ,CAIJ,SAAY,sBAJR,CAKJ,mBAAsB,+BALlB,CADZ,CAFR,CARK,CAoBL,CACIpD,KAAK,CAAErB,CAAS,CAAC,CAAD,CAAT,CAAe,KAAf,CAAuB,cAAE,uBAAyBN,CAA3B,EAAyC6E,IAAzC,EADlC,CAEIjD,KAAK,CAAE,aAFX,CAGIC,MAAM,CAAE,UAHZ,CAIIC,SAAS,CAAE,CAJf,CAKIsB,UAAU,GALd,CApBK,CA2BL,CACIzB,KAAK,CAAErB,CAAS,CAAC,EAAD,CADpB,CAEIsB,KAAK,CAAE,UAFX,CAEuBa,QAAQ,CAAE,QAFjC,CAE2CX,SAAS,CAAE,CAFtD,CAEyDsB,UAAU,GAFnE,CAE4EV,SAAS,CAE7E,mBAAUV,CAAV,CAAgB,CACZ,GAAIW,CAAAA,CAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ,CACAF,CAAK,CAACG,IAAN,CAAa,UAAb,CACAH,CAAK,CAACI,OAAN,CAAgBf,CAAI,CAACgB,QAAL,EAAhB,CACAL,CAAK,CAACM,gBAAN,CAAuB,OAAvB,CAAgC,UAAY,CACxCjB,CAAI,CAACG,MAAL,GAAcC,MAAd,CAAqB,CAAC,SAAY,cAAE,IAAF,EAAQc,IAAR,CAAa,SAAb,EAA0B,CAA1B,CAA8B,CAA3C,CAArB,CACH,CAFD,EAIA,MAAOP,CAAAA,CACV,CAbT,CA3BK,CA0CL,CACIhB,KAAK,CAAErB,CAAS,CAAC,EAAD,CADpB,CAEIsB,KAAK,CAAE,UAFX,CAEuBa,QAAQ,CAAE,QAFjC,CAE2CX,SAAS,CAAE,CAFtD,CAEyDsB,UAAU,GAFnE,CAE4EV,SAAS,CAC7E,mBAAUV,CAAV,CAAgB,CACZ,GAAIW,CAAAA,CAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ,CACAF,CAAK,CAACG,IAAN,CAAa,UAAb,CACAH,CAAK,CAACI,OAAN,CAAgBf,CAAI,CAACgB,QAAL,EAAhB,CACAL,CAAK,CAACM,gBAAN,CAAuB,OAAvB,CAAgC,UAAY,CACxCjB,CAAI,CAACG,MAAL,GAAcC,MAAd,CAAqB,CAAC,SAAY,cAAE,IAAF,EAAQc,IAAR,CAAa,SAAb,EAA0B,CAA1B,CAA8B,CAA3C,CAArB,CACH,CAFD,EAIA,MAAOP,CAAAA,CACV,CAZT,CA1CK,CAwDL,CACIhB,KAAK,CAAErB,CAAS,CAAC,EAAD,CAAT,CAAgB,KAAhB,CAAwB,cAAE,kBAAoBN,CAAtB,EAAoC6E,IAApC,EADnC,CAEIjD,KAAK,CAAE,YAFX,CAGIC,MAAM,CAAE,UAHZ,CAIIC,SAAS,CAAE,CAJf,CAKIsB,UAAU,GALd,CAxDK,CA+DL,CACIzB,KAAK,CAAE,EADX,CACewB,KAAK,CAAE,EADtB,CAC0BC,UAAU,GADpC,CAC6CX,QAAQ,CAAE,QADvD,CACiEC,SAAS,CAClE,oBAAY,CACR,MAAO,0CACV,CAJT,CAKIW,SAAS,CAAE,mBAAUC,CAAV,CAAatB,CAAb,CAAmB,CAC1BuB,UAAaC,MAAb,CAAoB,CAChBV,IAAI,CAAES,UAAaE,KAAb,CAAmBC,WADT,CAEhB/B,KAAK,CAAErB,CAAS,CAAC,CAAD,CAFA,CAGhBqD,IAAI,CAAErD,CAAS,CAAC,CAAD,CAHC,CAApB,EAKKD,IALL,CAKU,SAAUuD,CAAV,CAAiB,CACnBA,CAAK,CAACC,iBAAN,CAAwBvD,CAAS,CAAC,EAAD,CAAjC,EACAsD,CAAK,CAACE,OAAN,GAAgBC,EAAhB,CAAmBC,UAAYC,IAA/B,CAAqC,UAAY,CAC7CjC,CAAI,CAACG,MAAL,GAAc+B,MAAd,EACH,CAFD,EAGAN,CAAK,CAACO,IAAN,EACH,CAXL,CAYH,CAlBL,CA/DK,CAhBuD,CAAhD,CAApB,CAsGA,cAAE,yBAA2BnE,CAA7B,EAA2CoE,KAA3C,CAAiD,UAAY,CACzDE,CAAa,CAACD,MAAd,CAAqB,CAAC,SAAY,MAAb,CAAqB,SAAY,CAAjC,CAAoC,SAAY,CAAhD,CAAmD,WAAc,IAAjE,CAArB,CACH,CAFD,EAIA,GAAIW,CAAAA,CAAmB,CAAG,GAAIjE,UAAJ,CAAc,wBAA0Bf,CAAxC,CAAsD,CAC5EgB,IAAI,CAAEC,IAAI,CAACC,KAAL,CAAWL,CAAmB,CAACM,GAApB,EAAX,CADsE,CAE5EC,MAAM,CAAE,YAFoE,CAG5EmD,WAAW,GAHiE,CAI5EC,QAAQ,CAAE,mBAAY,CAElB,GAAIxD,CAAAA,CAAI,CAAGgE,CAAmB,CAACP,OAApB,GAA8BC,GAA9B,CAAkC,SAAAC,CAAG,QAAIA,CAAAA,CAAG,CAAC1C,OAAJ,EAAJ,CAArC,CAAX,CACAjB,CAAI,CAAGA,CAAI,CAACM,MAAL,CAAY,SAAAC,CAAK,QAAIA,CAAAA,CAAK,CAACqD,IAAV,CAAjB,CAAP,CACA/D,CAAmB,CAACM,GAApB,CAAwBF,IAAI,CAACQ,SAAL,CAAeT,CAAf,CAAxB,CACH,CAT2E,CAU5EK,WAAW,CAAE,sBAAY,CAErB,GAAIL,CAAAA,CAAI,CAAGgE,CAAmB,CAACP,OAApB,GAA8BC,GAA9B,CAAkC,SAAAC,CAAG,QAAIA,CAAAA,CAAG,CAAC1C,OAAJ,EAAJ,CAArC,CAAX,CACAjB,CAAI,CAAGA,CAAI,CAACM,MAAL,CAAY,SAAAC,CAAK,QAAIA,CAAAA,CAAK,CAACqD,IAAV,CAAjB,CAAP,CACA,cAAE,IAAM7E,CAAR,EAA+BoB,GAA/B,CAAmCF,IAAI,CAACQ,SAAL,CAAeT,CAAf,CAAnC,CACH,CAf2E,CAgB5EU,OAAO,CAAE,CACL,CACIC,KAAK,CAAErB,CAAS,CAAC,CAAD,CAAT,CAAe,KAAf,CAAuB,cAAE,gBAAkBN,CAApB,EAAkC6E,IAAlC,EADlC,CAEIjD,KAAK,CAAE,MAFX,CAGIC,MAAM,CAAE,OAHZ,CAIIC,SAAS,CAAE,CAJf,CAKIsB,UAAU,GALd,CADK,CAQL,CACIzB,KAAK,CAAErB,CAAS,CAAC,CAAD,CADpB,CACyBsB,KAAK,CAAE,UADhC,CAC4CE,SAAS,CAAE,CADvD,CAC0DsB,UAAU,GADpE,CAC6EvB,MAAM,CAAE,QADrF,CAC+FiD,YAAY,CACnG,CACIC,MAAM,CAAE,CACJ,KAAQ,eADJ,CAEJ,OAAU,oBAFN,CAGJ,aAAgB,uBAHZ,CAIJ,SAAY,sBAJR,CAKJ,mBAAsB,+BALlB,CADZ,CAFR,CARK,CAoBL,CACIpD,KAAK,CAAErB,CAAS,CAAC,CAAD,CAAT,CAAe,KAAf,CAAuB,cAAE,uBAAyBN,CAA3B,EAAyC6E,IAAzC,EADlC,CAEIjD,KAAK,CAAE,aAFX,CAGIC,MAAM,CAAE,UAHZ,CAIIC,SAAS,CAAE,CAJf,CAKIsB,UAAU,GALd,CApBK,CA2BL,CACIzB,KAAK,CAAErB,CAAS,CAAC,EAAD,CADpB,CAEIsB,KAAK,CAAE,UAFX,CAEuBa,QAAQ,CAAE,QAFjC,CAE2CX,SAAS,CAAE,CAFtD,CAEyDsB,UAAU,GAFnE,CAE4EV,SAAS,CAE7E,mBAAUV,CAAV,CAAgB,CACZ,GAAIW,CAAAA,CAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ,CACAF,CAAK,CAACG,IAAN,CAAa,UAAb,CACAH,CAAK,CAACI,OAAN,CAAgBf,CAAI,CAACgB,QAAL,EAAhB,CACAL,CAAK,CAACM,gBAAN,CAAuB,OAAvB,CAAgC,UAAY,CACxCjB,CAAI,CAACG,MAAL,GAAcC,MAAd,CAAqB,CAAC,SAAY,cAAE,IAAF,EAAQc,IAAR,CAAa,SAAb,EAA0B,CAA1B,CAA8B,CAA3C,CAArB,CACH,CAFD,EAIA,MAAOP,CAAAA,CACV,CAbT,CA3BK,CA0CL,CACIhB,KAAK,CAAErB,CAAS,CAAC,EAAD,CADpB,CAEIsB,KAAK,CAAE,UAFX,CAEuBa,QAAQ,CAAE,QAFjC,CAE2CX,SAAS,CAAE,CAFtD,CAEyDsB,UAAU,GAFnE,CAE4EV,SAAS,CAC7E,mBAAUV,CAAV,CAAgB,CACZ,GAAIW,CAAAA,CAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ,CACAF,CAAK,CAACG,IAAN,CAAa,UAAb,CACAH,CAAK,CAACI,OAAN,CAAgBf,CAAI,CAACgB,QAAL,EAAhB,CACAL,CAAK,CAACM,gBAAN,CAAuB,OAAvB,CAAgC,UAAY,CACxCjB,CAAI,CAACG,MAAL,GAAcC,MAAd,CAAqB,CAAC,SAAY,cAAE,IAAF,EAAQc,IAAR,CAAa,SAAb,EAA0B,CAA1B,CAA8B,CAA3C,CAArB,CACH,CAFD,EAIA,MAAOP,CAAAA,CACV,CAZT,CA1CK,CAwDL,CACIhB,KAAK,CAAErB,CAAS,CAAC,EAAD,CAAT,CAAgB,KAAhB,CAAwB,cAAE,kBAAoBN,CAAtB,EAAoC6E,IAApC,EADnC,CAEIjD,KAAK,CAAE,YAFX,CAGIC,MAAM,CAAE,UAHZ,CAIIC,SAAS,CAAE,CAJf,CAKIsB,UAAU,GALd,CAxDK,CA+DL,CACIzB,KAAK,CAAE,EADX,CACewB,KAAK,CAAE,EADtB,CAC0BC,UAAU,GADpC,CAC6CX,QAAQ,CAAE,QADvD,CACiEC,SAAS,CAClE,oBAAY,CACR,MAAO,0CACV,CAJT,CAKIW,SAAS,CAAE,mBAAUC,CAAV,CAAatB,CAAb,CAAmB,CAC1BuB,UAAaC,MAAb,CAAoB,CAChBV,IAAI,CAAES,UAAaE,KAAb,CAAmBC,WADT,CAEhB/B,KAAK,CAAErB,CAAS,CAAC,CAAD,CAFA,CAGhBqD,IAAI,CAAErD,CAAS,CAAC,CAAD,CAHC,CAApB,EAKKD,IALL,CAKU,SAAUuD,CAAV,CAAiB,CACnBA,CAAK,CAACC,iBAAN,CAAwBvD,CAAS,CAAC,EAAD,CAAjC,EACAsD,CAAK,CAACE,OAAN,GAAgBC,EAAhB,CAAmBC,UAAYC,IAA/B,CAAqC,UAAY,CAC7CjC,CAAI,CAACG,MAAL,GAAc+B,MAAd,EACH,CAFD,EAGAN,CAAK,CAACO,IAAN,EACH,CAXL,CAYH,CAlBL,CA/DK,CAhBmE,CAAtD,CAA1B,CAsGA,cAAE,+BAAiCnE,CAAnC,EAAiDoE,KAAjD,CAAuD,UAAY,CAC/DY,CAAmB,CAACX,MAApB,CAA2B,CAAC,SAAY,MAAb,CAAqB,SAAY,CAAjC,CAAoC,SAAY,CAAhD,CAAmD,WAAc,IAAjE,CAA3B,CACH,CAFD,CAGH,CA9SD,CA+SH,CAlUM,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to initialise the opencast block settings.\n *\n * @package    block_opencast\n * @copyright  2021 Tamara Gunkel, University of Münster\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Tabulator from 'block_opencast/tabulator';\nimport $ from 'jquery';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport * as str from 'core/str';\n\nexport const init = (rolesinputid, metadatainputid, metadataseriesinputid, ocinstanceid) => {\n\n    // Load strings\n    var strings = [\n        {key: 'heading_role', component: 'block_opencast'},\n        {key: 'heading_actions', component: 'block_opencast'},\n        {key: 'heading_permanent', component: 'block_opencast'},\n        {key: 'delete_role', component: 'block_opencast'},\n        {key: 'delete_confirm_role', component: 'block_opencast'},\n        {key: 'delete_metadata', component: 'block_opencast'},\n        {key: 'delete_confirm_metadata', component: 'block_opencast'},\n        {key: 'heading_name', component: 'block_opencast'},\n        {key: 'heading_datatype', component: 'block_opencast'},\n        {key: 'heading_description', component: 'block_opencast'},\n        {key: 'heading_required', component: 'block_opencast'},\n        {key: 'heading_readonly', component: 'block_opencast'},\n        {key: 'heading_params', component: 'block_opencast'},\n        {key: 'delete', component: 'moodle'}\n    ];\n    str.get_strings(strings).then(function (jsstrings) {\n        // Style hidden input.\n        var rolesinput = $('#' + rolesinputid);\n        rolesinput.parent().hide();\n        rolesinput.parent().next().hide(); // Default value.\n\n        // Don't create tables if they are not visible.\n        if(!rolesinput.length) {\n            return;\n        }\n\n        var metadatainput = $('#' + metadatainputid);\n        metadatainput.parent().hide();\n        metadatainput.parent().next().hide(); // Default value.\n\n        var metadataseriesinput = $('#' + metadataseriesinputid);\n        metadataseriesinput.parent().hide();\n        metadataseriesinput.parent().next().hide(); // Default value.\n\n        var rolestable = new Tabulator(\"#rolestable_\" + ocinstanceid, {\n            data: JSON.parse(rolesinput.val()),\n            layout: \"fitColumns\",\n            dataChanged: function (data) {\n                data = data.filter(value => value.rolename);\n                rolesinput.val(JSON.stringify(data));\n            },\n            columns: [\n                {\n                    title: jsstrings[0], field: \"rolename\", editor: \"input\", widthGrow: 4, cellEdited: function (cell) {\n                        if (cell.getData().rolename.includes('[USERNAME]') || cell.getData().rolename.includes('[USERNAME_LOW]') ||\n                            cell.getData().rolename.includes('[USERNAME_UP]')) {\n                            // Tick permanent checkbox.\n                            cell.getRow().update({'permanent': 1});\n                            cell.getRow().getCell(\"permanent\").getElement().getElementsByTagName(\"input\")[0].disabled = true;\n                        } else {\n                            cell.getRow().getCell(\"permanent\").getElement().getElementsByTagName(\"input\")[0].disabled = false;\n                        }\n                    }\n                },\n                {title: jsstrings[1], field: \"actions\", editor: \"input\", widthGrow: 1},\n                {\n                    title: jsstrings[2],\n                    field: \"permanent\",\n                    hozAlign: \"center\",\n                    widthGrow: 0,\n                    formatter: function (cell) {\n                        var input = document.createElement('input');\n                        input.type = 'checkbox';\n                        input.checked = cell.getValue();\n                        input.addEventListener('click', function () {\n                            cell.getRow().update({'permanent': $(this).prop('checked') ? 1 : 0});\n                        });\n\n                        if (cell.getData().rolename.includes('[USERNAME]') || cell.getData().rolename.includes('[USERNAME_LOW]') ||\n                            cell.getData().rolename.includes('[USERNAME_UP]')) {\n                            input.disabled = true;\n                        }\n\n                        return input;\n                    }\n                },\n                {\n                    title: \"\",\n                    width: 40,\n                    headerSort: false,\n                    hozAlign: \"center\",\n                    formatter: function () {\n                        return '<i class=\"icon fa fa-trash fa-fw\"></i>';\n                    },\n                    cellClick: function (e, cell) {\n                        ModalFactory.create({\n                            type: ModalFactory.types.SAVE_CANCEL,\n                            title: jsstrings[3],\n                            body: jsstrings[4]\n                        })\n                            .then(function (modal) {\n                                modal.setSaveButtonText(jsstrings[3]);\n                                modal.getRoot().on(ModalEvents.save, function () {\n                                    cell.getRow().delete();\n                                });\n                                modal.show();\n                            });\n                    }\n                }\n            ],\n        });\n\n        $('#addrow-rolestable_' + ocinstanceid).click(function () {\n            rolestable.addRow({'rolename': '', 'actions':'', 'permanent': 0});\n        });\n\n        var metadatatable = new Tabulator(\"#metadatatable_\" + ocinstanceid, {\n            data: JSON.parse(metadatainput.val()),\n            layout: \"fitColumns\",\n            movableRows: true,\n            rowMoved: function () {\n                // Order by row position\n                var data = metadatatable.getRows().map(row => row.getData());\n                data = data.filter(value => value.name);\n                metadatainput.val(JSON.stringify(data));\n            },\n            dataChanged: function () {\n                // Order by row position\n                var data = metadatatable.getRows().map(row => row.getData());\n                data = data.filter(value => value.name);\n                $('#' + metadatainputid).val(JSON.stringify(data));\n            },\n            columns: [\n                {\n                    title: jsstrings[7] + '   ' + $('#helpbtnname_' + ocinstanceid).html(),\n                    field: \"name\",\n                    editor: \"input\",\n                    widthGrow: 1,\n                    headerSort: false\n                },\n                {\n                    title: jsstrings[8], field: \"datatype\", widthGrow: 1, headerSort: false, editor: \"select\", editorParams:\n                        {\n                            values: {\n                                'text': 'String (text)',\n                                'select': 'Drop Down (select)',\n                                'autocomplete': 'Arrays (autocomplete)',\n                                'textarea': 'Long Text (textarea)',\n                                'date_time_selector': 'Date Time Selector (datetime)'\n                            }\n                        }\n                },\n                {\n                    title: jsstrings[9] + '   ' + $('#helpbtndescription_' + ocinstanceid).html(),\n                    field: \"description\",\n                    editor: \"textarea\",\n                    widthGrow: 2,\n                    headerSort: false\n                },\n                {\n                    title: jsstrings[10],\n                    field: \"required\", hozAlign: \"center\", widthGrow: 0, headerSort: false, formatter:\n\n                        function (cell) {\n                            var input = document.createElement('input');\n                            input.type = 'checkbox';\n                            input.checked = cell.getValue();\n                            input.addEventListener('click', function () {\n                                cell.getRow().update({'required': $(this).prop('checked') ? 1 : 0});\n                            });\n\n                            return input;\n                        }\n                },\n                {\n                    title: jsstrings[11],\n                    field: \"readonly\", hozAlign: \"center\", widthGrow: 0, headerSort: false, formatter:\n                        function (cell) {\n                            var input = document.createElement('input');\n                            input.type = 'checkbox';\n                            input.checked = cell.getValue();\n                            input.addEventListener('click', function () {\n                                cell.getRow().update({'readonly': $(this).prop('checked') ? 1 : 0});\n                            });\n\n                            return input;\n                        }\n                },\n                {\n                    title: jsstrings[12] + '   ' + $('#helpbtnparams_' + ocinstanceid).html(),\n                    field: \"param_json\",\n                    editor: \"textarea\",\n                    widthGrow: 2,\n                    headerSort: false\n                },\n                {\n                    title: \"\", width: 40, headerSort: false, hozAlign: \"center\", formatter:\n                        function () {\n                            return '<i class=\"icon fa fa-trash fa-fw\"></i>';\n                        },\n                    cellClick: function (e, cell) {\n                        ModalFactory.create({\n                            type: ModalFactory.types.SAVE_CANCEL,\n                            title: jsstrings[5],\n                            body: jsstrings[6]\n                        })\n                            .then(function (modal) {\n                                modal.setSaveButtonText(jsstrings[12]);\n                                modal.getRoot().on(ModalEvents.save, function () {\n                                    cell.getRow().delete();\n                                });\n                                modal.show();\n                            });\n                    }\n                }\n            ],\n        });\n\n        $('#addrow-metadatatable_' + ocinstanceid).click(function () {\n            metadatatable.addRow({'datatype': 'text', 'required': 0, 'readonly': 0, 'param_json': null});\n        });\n\n        var metadataseriestable = new Tabulator(\"#metadataseriestable_\" + ocinstanceid, {\n            data: JSON.parse(metadataseriesinput.val()),\n            layout: \"fitColumns\",\n            movableRows: true,\n            rowMoved: function () {\n                // Order by row position\n                var data = metadataseriestable.getRows().map(row => row.getData());\n                data = data.filter(value => value.name);\n                metadataseriesinput.val(JSON.stringify(data));\n            },\n            dataChanged: function () {\n                // Order by row position\n                var data = metadataseriestable.getRows().map(row => row.getData());\n                data = data.filter(value => value.name);\n                $('#' + metadataseriesinputid).val(JSON.stringify(data));\n            },\n            columns: [\n                {\n                    title: jsstrings[7] + '   ' + $('#helpbtnname_' + ocinstanceid).html(),\n                    field: \"name\",\n                    editor: \"input\",\n                    widthGrow: 1,\n                    headerSort: false\n                },\n                {\n                    title: jsstrings[8], field: \"datatype\", widthGrow: 1, headerSort: false, editor: \"select\", editorParams:\n                        {\n                            values: {\n                                'text': 'String (text)',\n                                'select': 'Drop Down (select)',\n                                'autocomplete': 'Arrays (autocomplete)',\n                                'textarea': 'Long Text (textarea)',\n                                'date_time_selector': 'Date Time Selector (datetime)'\n                            }\n                        }\n                },\n                {\n                    title: jsstrings[9] + '   ' + $('#helpbtndescription_' + ocinstanceid).html(),\n                    field: \"description\",\n                    editor: \"textarea\",\n                    widthGrow: 2,\n                    headerSort: false\n                },\n                {\n                    title: jsstrings[10],\n                    field: \"required\", hozAlign: \"center\", widthGrow: 0, headerSort: false, formatter:\n\n                        function (cell) {\n                            var input = document.createElement('input');\n                            input.type = 'checkbox';\n                            input.checked = cell.getValue();\n                            input.addEventListener('click', function () {\n                                cell.getRow().update({'required': $(this).prop('checked') ? 1 : 0});\n                            });\n\n                            return input;\n                        }\n                },\n                {\n                    title: jsstrings[11],\n                    field: \"readonly\", hozAlign: \"center\", widthGrow: 0, headerSort: false, formatter:\n                        function (cell) {\n                            var input = document.createElement('input');\n                            input.type = 'checkbox';\n                            input.checked = cell.getValue();\n                            input.addEventListener('click', function () {\n                                cell.getRow().update({'readonly': $(this).prop('checked') ? 1 : 0});\n                            });\n\n                            return input;\n                        }\n                },\n                {\n                    title: jsstrings[12] + '   ' + $('#helpbtnparams_' + ocinstanceid).html(),\n                    field: \"param_json\",\n                    editor: \"textarea\",\n                    widthGrow: 2,\n                    headerSort: false\n                },\n                {\n                    title: \"\", width: 40, headerSort: false, hozAlign: \"center\", formatter:\n                        function () {\n                            return '<i class=\"icon fa fa-trash fa-fw\"></i>';\n                        },\n                    cellClick: function (e, cell) {\n                        ModalFactory.create({\n                            type: ModalFactory.types.SAVE_CANCEL,\n                            title: jsstrings[5],\n                            body: jsstrings[6]\n                        })\n                            .then(function (modal) {\n                                modal.setSaveButtonText(jsstrings[12]);\n                                modal.getRoot().on(ModalEvents.save, function () {\n                                    cell.getRow().delete();\n                                });\n                                modal.show();\n                            });\n                    }\n                }\n            ],\n        });\n\n        $('#addrow-metadataseriestable_' + ocinstanceid).click(function () {\n            metadataseriestable.addRow({'datatype': 'text', 'required': 0, 'readonly': 0, 'param_json': null});\n        });\n    });\n};\n\n"],"file":"block_settings.min.js"}