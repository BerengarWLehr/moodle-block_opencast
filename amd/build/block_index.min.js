define ("block_opencast/block_index",["jquery","core/modal_factory","core/modal_events","core/str","core/url"],function(a,b,c,d,f){var g=function(d,g){var h=JSON.parse(a("#workflowsjson").text());a(".start-workflow").on("click",function(i){i.preventDefault();var e=a(i.currentTarget),j="<select class=\"custom-select mb-3\" id=\"workflowselect\" name=\"workflow\">";for(var k in h){j+="<option value=\""+k+"\">"+h[k].title+"</option>"}j+="</select>";b.create({type:b.types.SAVE_CANCEL,title:g[5],body:"<form id=\"startWorkflowForm\" method=\"post\" action=\""+f.relativeUrl("blocks/opencast/startworkflow.php",{courseid:d,videoid:e.data("id")})+"\"><div class=\"form-group\"><p>"+g[6]+"</p>"+j+"<div id=\"workflowdesc\"></div><iframe id=\"config-frame\" class=\"w-100 mh-100 border-0\" sandbox=\"allow-forms allow-scripts\" src=\"\"></iframe><input type=\"hidden\" name=\"configparams\" id=\"configparams\"></form>"}).then(function(b){b.setSaveButtonText(g[5]);var e=b.getRoot();e.on(c.save,function(a){document.getElementById("config-frame").contentWindow.postMessage("getdata","*");a.preventDefault()});b.show().then(function(){a("#workflowdesc").html(h[a("#workflowselect").val()].description);a("#config-frame").attr("src",f.relativeUrl("blocks/opencast/serveworkflowconfigpanel.php",{courseid:d,workflowid:a("#workflowselect").val()}));a("#workflowselect").change(function(){var b=a(this).val();a("#workflowdesc").html(h[b].description);a("#config-frame").attr("src",f.relativeUrl("blocks/opencast/serveworkflowconfigpanel.php",{courseid:d,workflowid:b}))})})})})},h=function(d,g){a(".report-problem").on("click",function(h){h.preventDefault();var e=a(h.currentTarget);b.create({type:b.types.SAVE_CANCEL,title:g[0],body:"<form id=\"reportProblemForm\" method=\"post\" action=\""+f.relativeUrl("blocks/opencast/reportproblem.php",{courseid:d,videoid:e.data("id")})+"\"><div class=\"form-group\"><label for=\"inputMessage\">"+g[1]+"</label><textarea class=\"form-control\" id=\"inputMessage\" name=\"inputMessage\" rows=\"4\" placeholder=\""+g[2]+"\"></textarea>  <div class=\"invalid-feedback d-none\" id=\"messageValidation\">"+g[3]+"</div></div></form>"}).then(function(b){b.setSaveButtonText(g[4]);var d=b.getRoot();d.on(c.save,function(b){if(a("#inputMessage").val()){a("#reportProblemForm").submit()}else{a("#inputMessage").addClass("is-invalid");a("#messageValidation").removeClass("d-none")}b.preventDefault()});b.show()})})};return{init:function init(b){d.get_strings([{key:"reportproblem_modal_title",component:"block_opencast"},{key:"reportproblem_modal_body",component:"block_opencast"},{key:"reportproblem_modal_placeholder",component:"block_opencast"},{key:"reportproblem_modal_required",component:"block_opencast"},{key:"reportproblem_modal_submit",component:"block_opencast"},{key:"startworkflow",component:"block_opencast"},{key:"startworkflow_modal_body",component:"block_opencast"}]).then(function(a){g(b,a);h(b,a)});window.addEventListener("message",function(b){if("null"!==b.origin){return}if(b.data===parseInt(b.data)){a("#config-frame").height(b.data)}else{a("#configparams").val(b.data);a("#startWorkflowForm").submit()}})}}});
//# sourceMappingURL=block_index.min.js.map
